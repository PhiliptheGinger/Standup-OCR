Adapted from 63/64/65.
